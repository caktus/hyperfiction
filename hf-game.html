<polymer-element name="hf-game" extends="hf-base">
    <template>
        <header>
            <h3> <i>You see...</i> </h3>
        </header>
        <content></content>
    </template>
    <script>
    Polymer('hf-game', {
        ready: function(){
            this.flags = {};
            var game = this;

            window.onhashchange = function(ev) {
                var name = ev.newURL.split('#')[1] || 'white-room';
                var scene = document.querySelector('hf-scene[name='+name+']');
                game.enterScene(scene);
            };
            window.onhashchange({newURL: window.location.toString()});

            var c = document.querySelectorAll('hf-condition[hasnot]');
            for (var i=0; i<c.length; i++) {
                c[i].addClass('condition-met');
            }
        },
        setFlag: function(flag) {
            this.flags[flag] = true;
            var c = document.querySelectorAll('hf-condition[has='+flag+']');
            for (var i=0; i<c.length; i++) {
                c[i].addClass('condition-met');
                c[i].setAttribute('class', 'condition-met');
            }
            c = document.querySelectorAll('hf-condition[hasnot='+flag+']');
            for (var i=0; i<c.length; i++) {
                console.log(c[i]);
                c[i].removeClass('condition-met');
            }
        },
        enterScene: function(scene) {
            if (this.scene) {
                this.scene.leave();
            }
            scene.enter();
            this.scene = scene;
            if (scene.level > 1) {
                back = document.getElementById('back');
            }
        }
    });
    </script>
</polymer-element>
